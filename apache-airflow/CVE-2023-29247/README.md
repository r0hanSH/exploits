
https://nvd.nist.gov/vuln/detail/CVE-2023-29247

Vuln: Stored XSS

Original Finder: taidh, kuteminh11

Exploit: r0hanSH

[Link to vulnerable code](https://github.com/apache/airflow/blob/cb842dd8aa8749b4d0a474c6e2fda11505d9ba99/airflow/www/static/js/task.js#L23-L34)

XSS payload examples: `http-- onmousemove=alert(document.domain)` or `javascript:alert('http--'+document.domain)`

---

## PoC

**STEP 1**: Open any DAG and click on `Trigger DAG w/ config`

![DAG Trigger IMG](https://raw.githubusercontent.com/r0hanSH/exploits/main/apache-airflow/CVE-2023-29247/airflow-1.png)

**STEP 2**: Enter the XSS payload in `Run id` field

![Run id IMG](https://raw.githubusercontent.com/r0hanSH/exploits/main/apache-airflow/CVE-2023-29247/airflow-2.png)

**STEP 3**: Visit the `Browse -> Task Instances` or visit `/taskinstance/list/` and click on your `Task Id`

![Task Id IMG](https://raw.githubusercontent.com/r0hanSH/exploits/main/apache-airflow/CVE-2023-29247/airflow-3.png)

**STEP 4**: Find a way to trigger (click link, mousemove etc.) your XSS payload based on your chosen XSS payload

![XSS Trigger IMG](https://raw.githubusercontent.com/r0hanSH/exploits/main/apache-airflow/CVE-2023-29247/airflow-4.png)
